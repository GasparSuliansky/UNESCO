library(dplyr)
library(ggplot2)
library(sf)
library(showtext)
font_add_google("Encode Sans", "encode sans")
showtext_auto()

shp_prov <- read_sf("/Users/gasparsuliansky/Downloads/DEPARTAMENTOS 1869-2010/Cartografia/PROVINCIAS_1960_ACT.shp") |> slice(-1)
shp_prov$cantidad <- as.numeric(c(24, 0, 10, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 10, 0, 1, 0, 0, 1, 0, 0, 0))  
locations <- data.frame(
  latitude = c(-32.6440, -41.1345, -34.6455, -30.7937, -41.1345, -31.428072529395163, -34.92570668992771, -34.650704310867596, -31.35645684456014, -31.404579095615826, -38.7166452411509, -34.430430894953325, -31.433749303918294, -41.12997759756577, -34.53303161162774, -34.66294173617321, -32.95372283822289, -41.12850897937149, -31.49646361423495, -34.599891642256615, -31.3844394946476, -41.12473032501785, -41.12368661297515, -34.908380808106266, -34.46286385531677, -34.588852863505934, -41.13934049922195, -31.385329695949533, -34.47980748504841, -41.12545826510391, -41.045181099138006, -38.00882774653474, -31.516475672247143, -38.717994260109, -41.13610281440879, -33.89078886364391, -34.611765649740974, -34.65886010507067, -34.587477391169635, -31.52876466114191, -31.41112172514962, -34.64692373343525, -34.7575126033899, -31.4102715758489, -34.613632064437105,-34.62891391367494),
  longitude = c(-68.9400, -71.2985, -58.3711, -64.32044, -71.2912, -64.13098335840468, -59.98368937457349, -58.430925687138696, -64.20255460258392, -64.17106793141778, -62.27926851768336, -58.88483870433514, -64.2639409890877, -71.28587436664768, -58.46744054481334, -58.54059090247985, -60.65857866020532, -71.3958474169843, -64.25708726025034, -58.37917738898808, -64.13707034675998, -71.24169030225453, -71.23466431759601, -57.95338667363644, -58.685408646663376, -58.487568415976085, -71.28431210225396, -64.19807468724144, -58.58146866596329, -71.36044913502326, -71.40975965890775, -57.53119197992804, -68.55069264490822, -62.26530109996424, -71.34266714458329, -60.57384161539531, -58.3768754159753, -58.524938458303126, -58.397912129470065, -64.45059178169389, -64.19182380258226, -58.37095307364509, -58.40800080432453, -64.19346915840529, -58.369700531316994, -58.4357207178226)
)

shp_prov |>
  ggplot() +
  geom_sf(fill = ifelse(shp_prov$cantidad > 0, "#0099CC", "grey90")) +
  geom_point(data = locations, aes(x = longitude, y = latitude), size = 1.5, col = "black", alpha = 0.5) +
  theme_void() +
  coord_sf(datum = NA) +
  xlim(-80, -50) +
  ylim(-58, -20) +
  theme(legend.title = element_blank())